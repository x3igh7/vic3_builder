(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{3406:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return n(3302)}])},8961:function(e,t,n){"use strict";var o=n(7294),r=n(7421);t.Z=()=>{let[e,t]=(0,o.useState)([]),[n,i]=(0,o.useState)([]),[a,u]=(0,o.useState)([]),[l,d]=(0,o.useState)([]),{t:c}=(0,r.$G)();return(0,o.useEffect)(()=>{fetch("data/buildings.json").then(e=>e.json()).then(e=>{t(e.map(e=>({...e,displayName:c(e.name)})))}),fetch("data/production_method_groups.json").then(e=>e.json()).then(e=>{i(e.map(e=>({...e,displayName:c(e.name)})))}),fetch("data/production_methods.json").then(e=>e.json()).then(e=>{u(e.map(e=>({...e,displayName:c(e.name)})))}),fetch("data/goods.json").then(e=>e.json()).then(e=>{d(e.map(e=>({...e,displayName:c(e.name)})))})},[]),{buildings:e,productionMethodGroups:n,productionMethods:a,goods:l}}},3302:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var o=n(58),r=n(7294),i=n(3308),a=n(7154),u=n(917),l=e=>{let{name:t,displayName:n,groupProductionMethods:i,selectedProductionMethod:l,onSelectedProductionMethodChange:d}=e,[c,s]=(0,r.useState)([]);return(0,r.useEffect)(()=>{s(i)},[]),(0,o.BX)("div",{css:(0,u.iv)({display:"flex",flexDirection:"column"}),children:[(0,o.tZ)("label",{css:{color:"var(--text-color-secondary)"},children:n}),(0,o.tZ)(a.Q,{field:"displayName",value:l,suggestions:c,completeMethod:e=>{s(i.filter(t=>t.displayName.toLowerCase().includes(e.query.toLowerCase())))},onSelect:e=>{var n;(null===(n=e.value)||void 0===n?void 0:n.hasOwnProperty("displayName"))&&i.some(t=>{var n;return t.displayName===(null===(n=e.value)||void 0===n?void 0:n.displayName)})&&d(t,e.value)},dropdown:!0,forceSelection:!0})]})},d=n(8184);let c=(e,t)=>(0,d.mZ)(e).reduce((e,n)=>{let o=t.find(e=>e.name===n.good);return o?e+n.amount*o.cost:e},0),s=(e,t)=>(0,d.Qy)(e).reduce((e,n)=>{let o=t.find(e=>e.name===n.good);return o?e+n.amount*o.cost:e},0),m=(e,t)=>{if(0!==t||0!==e)return t-e},p=(e,t,n,o)=>{if(0===t&&0===n)return;let r=o.find(t=>t.name===e),i=m(t,n);if((null==r?void 0:r.required_construction)&&i)return i/((null==r?void 0:r.required_construction)/20)},h=(e,t)=>{if(e&&t)return t/e*100},g=(e,t,n)=>{let o=c(e,t),r=s(e,t),i=p(e.name,o,r,n),a=h(o,r),u=m(o,r);return{name:e.name,constructionEfficiency:i,priceFlexibility:a,netValue:u}};var f=n(8961),v=e=>{let{buildingSetting:t}=e,{goods:n,buildings:i}=(0,f.Z)(),[a,l]=(0,r.useState)(void 0),d=(0,r.useMemo)(()=>{if(t&&n.length&&i.length)return g(t,n,i)},[t,n,i]);return((0,r.useEffect)(()=>{l(d)},[d]),a&&(a.constructionEfficiency||a.priceFlexibility||a.netValue)&&!(0>(a.constructionEfficiency||0)||0>(a.priceFlexibility||0)||0>(a.netValue||0)))?(0,o.BX)("div",{css:(0,u.iv)({display:"flex",gap:"1rem"}),children:[(0,o.tZ)("span",{css:(0,u.iv)({color:"var(--text-color-secondary)"}),children:"("}),void 0!==a.constructionEfficiency?(0,o.BX)("div",{children:[(0,o.tZ)("span",{css:(0,u.iv)({color:"var(--text-color)"}),children:"Construction Efficiency:"})," ",(0,o.BX)("span",{css:(0,u.iv)({color:"var(--highlight-text-color)"}),children:[a.constructionEfficiency.toFixed(1),"%"]})]}):(0,o.tZ)(o.HY,{}),void 0!==a.priceFlexibility?(0,o.BX)("div",{children:[(0,o.tZ)("span",{css:(0,u.iv)({color:"var(--text-color)"}),children:"Price Flexibility:"})," ",(0,o.BX)("span",{css:(0,u.iv)({color:"var(--highlight-text-color)"}),children:[a.priceFlexibility.toFixed(0),"%"]})]}):(0,o.tZ)(o.HY,{}),void 0!==a.netValue?(0,o.BX)("div",{children:[(0,o.tZ)("span",{css:(0,u.iv)({color:"var(--text-color)"}),children:"Net Value:"})," ",(0,o.BX)("span",{css:(0,u.iv)({color:"var(--highlight-text-color)"}),children:["+",a.netValue]})]}):(0,o.tZ)(o.HY,{}),(0,o.tZ)("span",{css:(0,u.iv)({color:"var(--text-color-secondary)"}),children:")"})]}):(0,o.tZ)(o.HY,{})},y=e=>{let{building:t,productionMethodGroups:n,productionMethods:r,buildingSetting:i,onSettingChange:a}=e,d=(e,t)=>{a({...i,production_method_groups:i.production_method_groups.map(n=>n.name===e?{...n,currentMethod:t}:n)})};return(0,o.BX)("div",{css:{marginBottom:"1rem"},children:[(0,o.BX)("div",{css:(0,u.iv)({display:"flex",gap:"1rem",alignItems:"baseline"}),children:[(0,o.tZ)("h3",{children:(0,o.tZ)("label",{children:null==t?void 0:t.displayName})}),(0,o.tZ)(v,{buildingSetting:i})]}),(0,o.tZ)("div",{css:(0,u.iv)({display:"flex",flexFlow:"row wrap",alignContent:"center",gap:"1rem"}),children:n.filter(e=>t.production_method_groups.includes(e.name)).map(e=>{var t;let n=r.filter(t=>e.production_methods.includes(t.name)),a=null===(t=i.production_method_groups.find(t=>t.name===e.name))||void 0===t?void 0:t.currentMethod;return(0,o.tZ)("div",{children:(0,o.tZ)(l,{name:e.name,displayName:e.displayName,groupProductionMethods:n,selectedProductionMethod:a||n[0],onSelectedProductionMethodChange:d})},e.name)})})]})},_=n(5600),Z=n(333),N=n(7374),x=n(9403),M=n(3279),E=n.n(M),b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{leading:!1,trailing:!0},o=(0,r.useRef)();return(0,r.useEffect)(()=>{o.current=e},[e]),(0,r.useMemo)(()=>E()(()=>{var e;null===(e=o.current)||void 0===e||e.call(o)},t,n),[])},S=n(7421),B=n(8981),C=()=>{let{t:e}=(0,S.$G)(),{buildings:t,productionMethods:n,productionMethodGroups:a}=(0,f.Z)(),[l,d]=(0,i._)([],B.N.VALUE),[c,s]=(0,r.useState)(""),[m,p]=(0,r.useState)([]),h=()=>c.length?l.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())):l,g=b(()=>{p(h())}),v=()=>t.map(t=>({name:t.name,displayName:e(t.name),unlocking_technologies:t.unlocking_technologies||[],production_method_groups:a.filter(e=>t.production_method_groups.includes(e.name)).map(t=>{let o=n.find(e=>t.production_methods[0]===e.name);return{name:t.name,displayName:e(t.name),currentMethod:o}})})).sort((e,t)=>e.name.localeCompare(t.name));(0,r.useEffect)(()=>{0===l.length&&t.length&&a.length&&n.length&&d(v())},[l,t,a,n]),(0,r.useEffect)(()=>{g()},[l]),(0,r.useEffect)(()=>{g()},[c]);let M=e=>{let t=l.filter(t=>t.name!==e.name);t.push(e),d(t.sort((e,t)=>e.name.localeCompare(t.name)))};return(0,o.BX)("div",{children:[(0,o.BX)("h1",{css:(0,u.iv)({display:"flex",alignContent:"center"}),children:[(0,o.tZ)("span",{children:"Production Method Settings"}),(0,o.tZ)(x.z,{icon:"pi pi-undo",rounded:!0,text:!0,severity:"warning","aria-label":"Reset",tooltip:"Reset Settings to Default",onClick:()=>{d(v())}})]}),(0,o.BX)("div",{css:(0,u.iv)({marginBottom:"3rem",display:"flex"}),children:[(0,o.BX)(N.D,{iconPosition:"left",children:[(0,o.tZ)(Z.S,{className:"pi pi-search"}),(0,o.tZ)(_.o,{value:c,placeholder:"Search Buildings",onChange:e=>{e.target.value!==c&&s(e.target.value)}})]}),(0,o.tZ)(x.z,{icon:"pi pi-times",severity:"danger","aria-label":"Cancel",disabled:!c,onClick:()=>{s("")}})]}),m.map(e=>{let r=t.find(t=>t.name===e.name);return(0,o.tZ)(y,{building:r,productionMethodGroups:a,productionMethods:n,buildingSetting:e,onSettingChange:M},e.name)})]})}},8184:function(e,t,n){"use strict";n.d(t,{Qy:function(){return i},UN:function(){return g},aN:function(){return o},mZ:function(){return r},xZ:function(){return c},yK:function(){return d}});let o=e=>e.sort((e,t)=>e.reduce((e,t)=>e+t.quantity,0)-t.reduce((e,t)=>e+t.quantity,0)),r=e=>e.production_method_groups.flatMap(e=>e.currentMethod.inputs?e.currentMethod.inputs:[]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),i=e=>e.production_method_groups.flatMap(e=>e.currentMethod.outputs?e.currentMethod.outputs.map(e=>e):[]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>{let n=e.amount;return e.good===t.good&&(n+=t.amount),{...e,amount:n}})]:[...e,t],[]),a=(e,t)=>t.filter(t=>t.production_method_groups.some(t=>{var n;return null===(n=t.currentMethod.outputs)||void 0===n?void 0:n.some(t=>t.good===e)})),u=(e,t)=>{let n=e.production_method_groups.filter(e=>{var n;return null===(n=e.currentMethod.outputs)||void 0===n?void 0:n.some(e=>e.good===t)}).reduce((e,n)=>{var o;return e+((null===(o=n.currentMethod.outputs)||void 0===o?void 0:o.reduce((e,n)=>n.good===t?e+n.amount:e,0))||0)},0);return{good:t,amount:n}},l=e=>e.flatMap(e=>[...e.totalInputs.map(e=>({...e}))]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),d=e=>e.flatMap(e=>[...e.totalOutputs.map(e=>({...e}))]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),c=e=>{let t=l(e),n=d(e);return t.map(e=>{let t=n.find(t=>t.good===e.good);return t?{good:e.good,amount:t.amount-e.amount}:{good:e.good,amount:0-e.amount}})},s=e=>{var t;return[...(null==e?void 0:e.unlocking_technologies)||[],...null===(t=e.production_method_groups)||void 0===t?void 0:t.flatMap(e=>{var t;return(null===(t=e.currentMethod)||void 0===t?void 0:t.unlocking_technologies)||[]})]},m=e=>e.filter(e=>{if(c(e).filter(e=>e.amount<0).length>0)return e}),p=(e,t,n,o)=>{let a=Math.ceil(-1*e.amount/t.amount),u=n.find(e=>e.name===o.name),l=u?u.quantity+a:a,d=i(o).map(e=>({...e,amount:e.amount*l})),c=r(o).map(e=>({...e,amount:e.amount*l}));return{name:o.name,displayName:o.displayName,requiredTechs:(null==u?void 0:u.requiredTechs)||s(o)||[],quantity:l,totalInputs:c,totalOutputs:d}},h=(e,t)=>{let n=m(e);if(!n.length)return e;let o=n[0],r=e.filter(e=>e!==o),i=c(o).filter(e=>e.amount<0);if(!i.length)return e;let l=i[0],d=a(l.good,t);if(!d.length)return e;let s=d.find(e=>o.some(t=>t.name===e.name));s||(s=d[0]),d.length>1&&d.filter(e=>e.name!==s.name).forEach(t=>{if(e.some(e=>e.some(e=>e.name===t.name)))return;let n=o.map(e=>({...e})),i=p(l,u(t,l.good),n,t);r.push([...n,i])});let g=u(s,l.good),f=p(l,g,o,s);return h([...r,[...o.filter(e=>e.name!==f.name),f]],t)},g=(e,t,n)=>{let o={...n.find(t=>t.name===e.name)},a=r(o).map(e=>{let n=e.amount*t;return{...e,amount:n}}),u=i(o).map(e=>{let n=e.amount*t;return{...e,amount:n}}),l=[];return l.push({name:o.name,displayName:o.displayName,requiredTechs:s(o),quantity:t,totalInputs:a,totalOutputs:u}),h([l],n)}}},function(e){e.O(0,[154,296,888,774,179],function(){return e(e.s=3406)}),_N_E=e.O()}]);