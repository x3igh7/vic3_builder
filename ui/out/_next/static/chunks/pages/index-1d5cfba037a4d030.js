(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(9502)}])},8961:function(e,t,n){"use strict";var o=n(7294),u=n(3308);t.Z=()=>{let[e,t]=(0,o.useState)([]),[n,i]=(0,o.useState)([]),[r,d]=(0,o.useState)([]),[a,l]=(0,u._)([],"settings");(0,o.useEffect)(()=>{fetch("data/buildings.json").then(e=>e.json()).then(e=>t(e)),fetch("data/production_method_groups.json").then(e=>e.json()).then(e=>i(e)),fetch("data/production_methods.json").then(e=>e.json()).then(e=>d(e))},[]);let s=()=>e.map(e=>({name:e.name,unlocking_technologies:e.unlocking_technologies||[],productionMethodGroups:n.filter(t=>e.production_method_groups.includes(t.name)).map(e=>{let t=r.find(t=>e.production_methods[0]===t.name);return{name:e.name,currentMethod:t}})})).sort((e,t)=>e.name.localeCompare(t.name));return(0,o.useEffect)(()=>{0===a.length&&e.length&&n.length&&r.length&&l(s())},[a,e,n,r]),{buildings:e,productionMethodGroups:n,productionMethods:r,settings:a,getDefaultSettings:s}}},9502:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var o=n(4386),u=n(7294),i=n(7154),r=n(4182),d=n(917),a=e=>{let{buildings:t,selectedBuilding:n,buildingQuantity:a,onSelectedBuildingChange:l,onBuildingQuantityChange:s}=e,[c,m]=(0,u.useState)(),[h,g]=(0,u.useState)([]);return(0,u.useEffect)(()=>{g(t)},[t]),(0,u.useEffect)(()=>{n&&m(n.name)},[n]),(0,o.BX)("div",{children:[(0,o.BX)("div",{css:(0,d.iv)({marginBottom:"1rem"}),children:[(0,o.tZ)("label",{htmlFor:"buildingSelector",css:(0,d.iv)({marginRight:"1rem"}),children:"Building Type"}),(0,o.tZ)(i.Q,{inputId:"buildingSelector",field:"name",suggestions:h,value:c,completeMethod:e=>{g(t.filter(t=>t.name.toLowerCase().includes(e.query.toLowerCase())))},onChange:e=>{m(e.value)},onSelect:e=>{l(e.value)},dropdown:!0,dropdownMode:"current",forceSelection:!0})]}),(0,o.BX)("div",{children:[(0,o.tZ)("label",{htmlFor:"quantityInput",css:(0,d.iv)({marginRight:"1rem"}),children:"Quantity"}),(0,o.tZ)(r.R,{inputId:"quantityInput",value:a,onChange:e=>{s(e.value)}})]})]})},l=n(8961);let s=e=>e.productionMethodGroups.flatMap(e=>e.currentMethod.inputs?e.currentMethod.inputs:[]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),c=e=>e.productionMethodGroups.flatMap(e=>e.currentMethod.outputs?e.currentMethod.outputs:[]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),m=(e,t)=>{var n,o;let u=t.find(t=>t.productionMethodGroups.some(t=>{var n;return null===(n=t.currentMethod.outputs)||void 0===n?void 0:n.some(t=>t.good===e)}));if(!u)return[void 0,void 0];let i=null===(o=u.productionMethodGroups.find(t=>{var n;return null===(n=t.currentMethod.outputs)||void 0===n?void 0:n.some(t=>t.good===e)}))||void 0===o?void 0:null===(n=o.currentMethod.outputs)||void 0===n?void 0:n.find(t=>t.good===e);return[u,i]},h=e=>e.flatMap(e=>[...e.totalInputs.map(e=>({...e}))]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),g=e=>e.flatMap(e=>[...e.totalOutputs.map(e=>({...e}))]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),p=e=>{let t=h(e),n=g(e);return t.map(e=>{let t=n.find(t=>t.good===e.good);return t?{good:e.good,amount:t.amount-e.amount}:{good:e.good,amount:0-e.amount}})},v=e=>{var t;return[...(null==e?void 0:e.unlocking_technologies)||[],...null===(t=e.productionMethodGroups)||void 0===t?void 0:t.flatMap(e=>{var t;return(null===(t=e.currentMethod)||void 0===t?void 0:t.unlocking_technologies)||[]})]},f=(e,t)=>{let n=p(e).filter(e=>e.amount<0);if(0===n.length)return e;let o=n[0],[u,i]=m(o.good,t);if(!u||!i)return e;let r=Math.ceil(-1*o.amount/i.amount),d=e.find(e=>e.name===u.name),a=d?d.quantity+r:r,l=c(u).map(e=>({...e,amount:e.amount*a})),h=s(u).map(e=>({...e,amount:e.amount*a}));return f([...e.filter(e=>e.name!==u.name),{name:u.name,requiredTechs:(null==d?void 0:d.requiredTechs)||v(u)||[],quantity:a,totalInputs:h,totalOutputs:l}],t)},M=(e,t,n)=>{let o=n.find(t=>t.name===e.name),u=s(o).map(e=>({...e,amount:e.amount=e.amount*t})),i=c(o).map(e=>({...e,amount:e.amount=e.amount*t})),r=[];return r.push({name:o.name,requiredTechs:v(o),quantity:t,totalInputs:u,totalOutputs:i}),f(r,n)};var B=e=>{let{selectedBuilding:t,quantity:n}=e,{settings:i}=(0,l.Z)(),[r,a]=(0,u.useState)([]);return((0,u.useEffect)(()=>{t&&n&&a(M(t,n,i))},[t]),t&&n)?(0,o.BX)("div",{children:[(0,o.tZ)("h2",{children:"Building Chain Results"}),(0,o.BX)("div",{css:(0,d.iv)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"1rem"}),children:[(0,o.BX)("div",{css:(0,d.iv)({flex:"1 auto"}),children:[(0,o.tZ)("h3",{children:"Buildings"}),r.map(e=>(0,o.BX)("div",{css:(0,d.iv)({"> *":{marginRight:"1rem"}}),children:[(0,o.BX)("label",{children:[e.name,": "]}),(0,o.tZ)("span",{css:(0,d.iv)({color:"#9eade6"}),children:e.quantity})]},e.name))]}),(0,o.BX)("div",{css:(0,d.iv)({flex:"1 auto"}),children:[(0,o.tZ)("h3",{children:"Output Deltas"}),(()=>{let e=p(r),t=g(r);return e.map(e=>{var n;let u=e.amount<0?"red":"green",i=(null===(n=t.find(t=>t.good===e.good))||void 0===n?void 0:n.amount)||0;return(0,o.BX)("div",{css:(0,d.iv)({"> *":{marginRight:"1rem"}}),children:[(0,o.tZ)("label",{children:e.good}),(0,o.BX)("span",{css:{color:"var(--text-color-secondary)"},children:["Total: ",i]}),(0,o.BX)("span",{css:{color:u},children:["Excess: ",e.amount]})]},e.good)})})()]}),(0,o.BX)("div",{css:(0,d.iv)({flex:"1 auto"}),children:[(0,o.tZ)("h3",{children:"Required Technologies"}),(()=>{let e=r.flatMap(e=>e.requiredTechs)||[];return e.length?e.map(e=>(0,o.tZ)("div",{children:(0,o.tZ)("label",{children:e})},e)):(0,o.tZ)("div",{children:"No technologies required"})})()]})]})]}):(0,o.tZ)("div",{})};function _(){let[e,t]=(0,u.useState)(),[n,i]=(0,u.useState)(5),{buildings:r}=(0,l.Z)();return(0,o.BX)("main",{children:[(0,o.tZ)("h1",{children:"Vic3 Builder"}),(0,o.tZ)(a,{buildings:r,selectedBuilding:e,buildingQuantity:n,onSelectedBuildingChange:e=>{t(e)},onBuildingQuantityChange:e=>{i(e)}}),(0,o.tZ)(B,{selectedBuilding:e,quantity:n})]})}}},function(e){e.O(0,[154,182,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);