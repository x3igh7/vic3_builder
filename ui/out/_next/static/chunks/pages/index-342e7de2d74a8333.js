(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2302)}])},8961:function(e,t,n){"use strict";var o=n(7294),u=n(7421);t.Z=()=>{let[e,t]=(0,o.useState)([]),[n,r]=(0,o.useState)([]),[i,a]=(0,o.useState)([]),[d,l]=(0,o.useState)([]),{t:s}=(0,u.$G)();return(0,o.useEffect)(()=>{fetch("data/buildings.json").then(e=>e.json()).then(e=>{t(e.map(e=>({...e,displayName:s(e.name)})))}),fetch("data/production_method_groups.json").then(e=>e.json()).then(e=>{r(e.map(e=>({...e,displayName:s(e.name)})))}),fetch("data/production_methods.json").then(e=>e.json()).then(e=>{a(e.map(e=>({...e,displayName:s(e.name)})))}),fetch("data/goods.json").then(e=>e.json()).then(e=>{l(e.map(e=>({...e,displayName:s(e.name)})))})},[]),{buildings:e,productionMethodGroups:n,productionMethods:i,goods:d}}},2302:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var o=n(58),u=n(7294),r=n(7154),i=n(4182),a=n(917),d=e=>{let{buildings:t,selectedBuilding:n,buildingQuantity:d,onSelectedBuildingChange:l,onBuildingQuantityChange:s}=e,[c,m]=(0,u.useState)(),[h,p]=(0,u.useState)([]);return(0,u.useEffect)(()=>{p(t)},[t]),(0,u.useEffect)(()=>{n&&m(n.displayName)},[n]),(0,o.BX)("div",{children:[(0,o.BX)("div",{css:(0,a.iv)({marginBottom:"1rem"}),children:[(0,o.tZ)("label",{htmlFor:"buildingSelector",css:(0,a.iv)({marginRight:"1rem"}),children:"Building Type"}),(0,o.tZ)(r.Q,{inputId:"buildingSelector",field:"displayName",suggestions:h,value:c,completeMethod:e=>{p(t.filter(t=>t.displayName.toLowerCase().includes(e.query.toLowerCase())))},onChange:e=>{m(e.value)},onSelect:e=>{l(e.value)},dropdown:!0,dropdownMode:"current",forceSelection:!0})]}),(0,o.BX)("div",{children:[(0,o.tZ)("label",{htmlFor:"quantityInput",css:(0,a.iv)({marginRight:"1rem"}),children:"Quantity"}),(0,o.tZ)(i.R,{inputId:"quantityInput",value:d,onChange:e=>{s(e.value)}})]})]})},l=n(8961),s=n(8184),c=n(3308),m=n(7421),h=e=>{let{selectedBuilding:t,quantity:n}=e,{t:r}=(0,m.$G)(),[i]=(0,c._)([],"settings_v4"),[d,l]=(0,u.useState)([]);(0,u.useEffect)(()=>{if(t&&n&&i.length){let e=(0,s.UN)(t,n,i);l([...e=(0,s.aN)(e)])}},[t,n,i]);let h=e=>e.map(e=>(0,o.BX)("div",{css:(0,a.iv)({"> *":{marginRight:"1rem"}}),children:[(0,o.BX)("label",{children:[e.displayName,": "]}),(0,o.tZ)("span",{css:(0,a.iv)({color:"#9eade6"}),children:e.quantity})]},e.name)),p=e=>{let t=(0,s.xZ)(e);return(0,s.yK)(e).map(e=>{let n=t.find(t=>e.good===t.good),u=void 0!==n?n.amount:e.amount;return(0,o.BX)("div",{css:(0,a.iv)({"> *":{marginRight:"1rem"}}),children:[(0,o.tZ)("label",{children:r(e.good)}),(0,o.BX)("span",{css:{color:"var(--text-color-secondary)"},children:["Total: ",e.amount]}),(0,o.BX)("span",{css:{color:u<0?"red":"green"},children:["Excess: ",u]})]},e.good)})},g=e=>{let t=Array.from(new Set(e.flatMap(e=>e.requiredTechs)||[]));return t.length?t.map(e=>(0,o.tZ)("div",{children:(0,o.tZ)("label",{children:e})},e)):(0,o.tZ)("div",{children:"No technologies required"})};return t&&n?(0,o.BX)("div",{children:[(0,o.tZ)("h2",{children:"Building Chain Results"}),d.map((e,t)=>(0,o.BX)("div",{css:(0,a.iv)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"1rem"}),children:[(0,o.BX)("div",{css:(0,a.iv)({flex:"1 auto"}),children:[(0,o.tZ)("h3",{children:"Buildings"}),h(e)]}),(0,o.BX)("div",{css:(0,a.iv)({flex:"1 auto"}),children:[(0,o.tZ)("h3",{children:"Outputs"}),p(e)]}),(0,o.BX)("div",{css:(0,a.iv)({flex:"1 auto"}),children:[(0,o.tZ)("h3",{children:"Required Technologies"}),g(e)]})]},t))]}):(0,o.tZ)("div",{})};function p(){let[e,t]=(0,c.Xs)(void 0,"buildingSelected"),[n,u]=(0,c.Xs)(5,"buildingQuantity"),{buildings:r}=(0,l.Z)();return(0,o.BX)("main",{children:[(0,o.tZ)("h1",{children:"Vic3 Builder"}),(0,o.tZ)(d,{buildings:r,selectedBuilding:e,buildingQuantity:n,onSelectedBuildingChange:e=>{t(e)},onBuildingQuantityChange:e=>{u(e)}}),(0,o.tZ)(h,{selectedBuilding:e,quantity:n})]})}},8184:function(e,t,n){"use strict";n.d(t,{Qy:function(){return r},UN:function(){return g},aN:function(){return o},mZ:function(){return u},xZ:function(){return s},yK:function(){return l}});let o=e=>e.sort((e,t)=>e.reduce((e,t)=>e+t.quantity,0)-t.reduce((e,t)=>e+t.quantity,0)),u=e=>e.production_method_groups.flatMap(e=>e.currentMethod.inputs?e.currentMethod.inputs:[]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),r=e=>e.production_method_groups.flatMap(e=>e.currentMethod.outputs?e.currentMethod.outputs.map(e=>e):[]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>{let n=e.amount;return e.good===t.good&&(n+=t.amount),{...e,amount:n}})]:[...e,t],[]),i=(e,t)=>t.filter(t=>t.production_method_groups.some(t=>{var n;return null===(n=t.currentMethod.outputs)||void 0===n?void 0:n.some(t=>t.good===e)})),a=(e,t)=>{let n=e.production_method_groups.filter(e=>{var n;return null===(n=e.currentMethod.outputs)||void 0===n?void 0:n.some(e=>e.good===t)}).reduce((e,n)=>{var o;return e+((null===(o=n.currentMethod.outputs)||void 0===o?void 0:o.reduce((e,n)=>n.good===t?e+n.amount:e,0))||0)},0);return{good:t,amount:n}},d=e=>e.flatMap(e=>[...e.totalInputs.map(e=>({...e}))]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),l=e=>e.flatMap(e=>[...e.totalOutputs.map(e=>({...e}))]).reduce((e,t)=>e.some(e=>e.good===t.good)?[...e.map(e=>(e.good===t.good&&(e.amount+=t.amount),e))]:[...e,t],[]),s=e=>{let t=d(e),n=l(e);return t.map(e=>{let t=n.find(t=>t.good===e.good);return t?{good:e.good,amount:t.amount-e.amount}:{good:e.good,amount:0-e.amount}})},c=e=>{var t;return[...(null==e?void 0:e.unlocking_technologies)||[],...null===(t=e.production_method_groups)||void 0===t?void 0:t.flatMap(e=>{var t;return(null===(t=e.currentMethod)||void 0===t?void 0:t.unlocking_technologies)||[]})]},m=e=>e.filter(e=>{if(s(e).filter(e=>e.amount<0).length>0)return e}),h=(e,t,n,o)=>{let i=Math.ceil(-1*e.amount/t.amount),a=n.find(e=>e.name===o.name),d=a?a.quantity+i:i,l=r(o).map(e=>({...e,amount:e.amount*d})),s=u(o).map(e=>({...e,amount:e.amount*d}));return{name:o.name,displayName:o.displayName,requiredTechs:(null==a?void 0:a.requiredTechs)||c(o)||[],quantity:d,totalInputs:s,totalOutputs:l}},p=(e,t)=>{let n=m(e);if(!n.length)return e;let o=n[0],u=e.filter(e=>e!==o),r=s(o).filter(e=>e.amount<0);if(!r.length)return e;let d=r[0],l=i(d.good,t);if(!l.length)return e;let c=l.find(e=>o.some(t=>t.name===e.name));c||(c=l[0]),l.length>1&&l.filter(e=>e.name!==c.name).forEach(t=>{if(e.some(e=>e.some(e=>e.name===t.name)))return;let n=o.map(e=>({...e})),r=h(d,a(t,d.good),n,t);u.push([...n,r])});let g=a(c,d.good),f=h(d,g,o,c);return p([...u,[...o.filter(e=>e.name!==f.name),f]],t)},g=(e,t,n)=>{let o={...n.find(t=>t.name===e.name)},i=u(o).map(e=>{let n=e.amount*t;return{...e,amount:n}}),a=r(o).map(e=>{let n=e.amount*t;return{...e,amount:n}}),d=[];return d.push({name:o.name,displayName:o.displayName,requiredTechs:c(o),quantity:t,totalInputs:i,totalOutputs:a}),p([d],n)}}},function(e){e.O(0,[154,182,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);